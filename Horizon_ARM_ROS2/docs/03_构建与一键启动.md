# 系统构建与启动

## 环境准备

### 前置要求
- Ubuntu 22.04 LTS
- ROS2 Humble
- Python 3.10+
- 机械臂硬件驱动SDK

### 依赖安装
```bash
# 安装ROS2依赖
sudo apt update
sudo apt install ros-humble-moveit ros-humble-ros2-control

# 安装Python依赖
pip3 install PyYAML tkinter numpy

# 配置串口权限
sudo usermod -a -G dialout $USER
```

## 系统构建

### 编译构建
```bash
# 进入工作空间
cd ~/Horizon_ARM_ROS2

# 编译ROS2功能包
colcon build --symlink-install

# 加载环境变量
source install/setup.bash
```

### 配置验证
```bash
# 检查功能包
ros2 pkg list | grep horizon

# 验证launch文件
ros2 launch --list | grep bringup
```

## 系统启动

### 一键启动
```bash
# 启动完整教学平台
ros2 launch horizon_arm_bridge bringup_sdk_ui.launch.py
```

启动后系统将自动加载：
- **MoveIt2运动规划服务**：提供路径规划和碰撞检测
- **RViz可视化界面**：3D仿真和轨迹显示  
- **硬件控制界面**：图形化操作和状态监控
- **驱动桥接节点**：ROS话题和硬件接口转换

### 分模块启动
```bash
# 仅启动驱动节点
ros2 launch horizon_arm_bridge driver_only.launch.py

# 仅启动运动规划
ros2 launch horizon_arm_moveit_config demo.launch.py
```

## 示例程序

### 基础控制示例
```bash
# 加载环境
source install/setup.bash

# 基础关节控制
python3 examples/basic_joint_control.py

# 轨迹跟踪演示
python3 examples/servo_square.py

# 抓取放置演示  
python3 examples/pick_and_place_demo.py
```

### 系统验证工具
```bash
# 关节状态监控
python3 examples/map_check.py

# 硬件连接测试
ros2 topic list | grep horizon

# 话题数据检查
ros2 topic echo /joint_states
```

## 故障排除

### 常见问题
- **编译失败**：检查ROS2环境和依赖包安装
- **串口权限**：确认用户已加入dialout用户组
- **界面无响应**：检查显示服务和X11转发配置

### 日志分析
```bash
# 查看节点日志
ros2 node info /trajectory_stream_sdk_driver

# 检查话题连接
ros2 topic info /horizon_arm/servo_target
```
